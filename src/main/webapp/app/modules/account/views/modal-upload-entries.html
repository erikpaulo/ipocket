<!-- BEGIN PAGE LEVEL STYLES -->
<link href="resources/lib/hint.css/hint.min.css" rel="stylesheet" type="text/css" />
<link href="resources/styles/forms.css" rel="stylesheet" type="text/css" />
<link href="resources/styles/table.css" rel="stylesheet" type="text/css" />
<!-- END PAGE LEVEL STYLESE -->
<div class="content" nv-file-drop="" uploader="uploader" filters="queueLimit, csvFilter">

	<div class="page-title">
		<div class="modaltitle">
			<h3>
				Importar <span class="semi-bold">Lançamentos</span>
			</h3>
		</div>
	</div>

	<div message-box handler="messageHandler" enable-remove="true"
		style="margin-bottom: 10px"></div>

	<div class="form-group">
		<div class="grid simple">
			<div class="grid-body no-border" style="overflow: hidden; display: block;">
				<br>
				<form name="form_import" novalidate="novalidate">
					<div class="row form-row">
     					<div class="col-md-12" style="margin-bottom: 40px">
		                    <table class="table" ng-show="uploader.queue.length > 0">
		                        <thead>
		                            <tr>
		                                <th width="50%">Nome</th>
		                                <th ng-show="uploader.isHTML5">Tamanho</th>
		                                <th ng-show="uploader.isHTML5">Progresso</th>
		                                <th>Situação</th>
		                                <th>Ações</th>
		                            </tr>
		                        </thead>
		                        <tbody>
		                            <tr ng-repeat="item in uploader.queue">
		                                <td><strong>{{ item.file.name }}</strong></td>
		                                <td ng-show="uploader.isHTML5" nowrap>{{ item.file.size/1024|number:2 }} KB</td>
		                                <td ng-show="uploader.isHTML5">
		                                    <div class="progress" style="margin-bottom: 0;">
		                                        <div class="progress-bar" role="progressbar" ng-style="{ 'width': item.progress + '%' }"></div>
		                                    </div>
		                                </td>
		                                <td class="text-center">
		                                    <span ng-show="item.isSuccess"><i class="glyphicon glyphicon-ok"></i></span>
		                                    <span ng-show="item.isCancel"><i class="glyphicon glyphicon-ban-circle"></i></span>
		                                    <span ng-show="item.isError"><i class="glyphicon glyphicon-remove"></i></span>
		                                </td>
		                                <td nowrap>
		                                    <button type="button" class="btn btn-success btn-small" ng-click="item.upload()" ng-disabled="item.isReady || item.isUploading || item.isSuccess">
		                                        <span class="glyphicon glyphicon-upload"></span> Upload
		                                    </button>
		                                    <button type="button" class="btn btn-warning btn-small" ng-click="item.cancel()" ng-disabled="!item.isUploading">
		                                        <span class="glyphicon glyphicon-ban-circle"></span> Cancel
		                                    </button>
		                                    <button type="button" class="btn btn-danger btn-small" ng-click="item.remove()" ng-disabled="item.isReady || item.isUploading || item.isSuccess">
		                                        <span class="glyphicon glyphicon-trash"></span> Remove
		                                    </button>
		                                </td>
		                            </tr>
		                        </tbody>
		                    </table>
		                    <br>
							<div nv-file-drop="" uploader="uploader"">
							    <div nv-file-over="" uploader="uploader" over-class="my-drop-zone-over" class="my-drop-zone">
							        <span>Solte os arquivos CSV aqui.</span>
							    </div>
							</div>
						</div>
					</div>
					<div class="entries-to-import">
						<div class="row form-row">
							<div class="col-md-12">
								<div class="fixed-table-container" ng-show="entriesToImport.length > 0">
									<div class="fixed-table-container-inner">
										<div class="header-background"> </div>
											<table class="table table-hover no-more-tables">
										  		<thead>
										  			<tr>
										  				<td><div class="th-inner">Data</div></td>
										  				<td><div class="th-inner">Descrição</div></td>
										  				<td><div class="th-inner">Categoria</div></td>
										  				<td><div class="th-inner">Valor</div></td>
										  				<td><div class="th-inner">Conflito</div></td>
										  			</tr>
										  		</thead>
										  		<tbody>
										  			<tr ng-repeat="entryToImport in entriesToImport">
										  				<td>{{entryToImport.date | date:"dd/MM/yyyy"}}</td>
										  				<td>{{entryToImport.description}}</td>
										  				<td>
										  					<div class="controls">
																<select ui-select2	ng-model="entryToImport.category.id" name="entryToImport.category.id" data-placeholder="Selecione" class="select2 form-control">
																	<option value=""></option>
																	<option	ng-repeat="category in categories"	value="{{category.id}}"	ng-selected="{{category.id == entryToImport.category.id}}">{{category.fullName}}</option>
																</select>
															</div>
														</td>
										  				<td ng-class="{positive: entryToImport.amount>0, negative: entryToImport.amount<0 }">{{entryToImport.amount | currency:"R$ "}}</td>
														<td>
															<span style="cursor:pointer;" tooltip="{{getConflictsText(entryToImport.conflicts)}}" class="label" ng-click="entryToImport.ok = !entryToImport.ok" ng-class="{'label-important': !entryToImport.ok, 'label-success': entryToImport.ok}">{{(entryToImport.ok ? 'Ok' : 'NOk')}}</span>
														</td>
										  			</tr>
										  		</tbody>
											</table>
									</div>
								</div>
							</div>
						</div>
						<div class="row form-row">
							<div class="col-md-12">
						     	<div class="form-actions">
									<div class="pull-right">
										<button type="button" class="btn btn-white btn-cons" ng-click="cancel()">Cancelar</button>
										<button type="submit" class="btn btn-success btn-cons" ng-click="ok(form_new_account)" ng-disabled="entriesToImport.length <= 0">
											<i class="icon-ok"></i> Incluir
										</button>
									</div>
								</div>
						     </div>
		                </div>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>
